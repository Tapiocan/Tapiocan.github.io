<!DOCTYPE html>
<html>

<head>
	<title>Tornados en Estados Unidos</title>
	<script src="https://cdn.plot.ly/plotly-2.34.0.min.js"></script>
	<link rel="stylesheet" href="style.css">
</head>

<body>
	<div class="div_titulo">
		<h1>Número de fallecidos por tornados en EEUU</h1>
	</div>

	<div id="myMap" style="width: 100%; height: 600px;"></div>

	<script>
		fetch('fallecidos_por_estado.json').then(response => response.json()).then(datos => {
			const estados = datos.map(item => item.estado);
			const nombre_estados = ['Alaska', 'Alabama', 'Arkansas', 'Arizona', 'California', 'Colorado', 'Connecticut', 'Distrito de Columbia', 'Delaware', 'Florida', 'Georgia', 'Hawái', 'Iowa', 'Idaho', 'Illinois', 'Indiana', 'Kansas', 'Kentucky', 'Luisiana', 'Massachusetts', 'Maryland', 'Maine', 'Míchigan', 'Minnesota', 'Misuri', 'Misisipi', 'Montana', 'Carolina del Norte', 'Dakota del Norte', 'Nebraska', 'Nuevo Hampshire', 'Nueva Jersey', 'Nuevo México', 'Nevada', 'Nueva York', 'Ohio', 'Oklahoma', 'Oregón', 'Pensilvania', 'Puerto Rico', 'Rhode Island', 'Carolina del Sur', 'Dakota del Sur', 'Tennessee', 'Texas', 'Utah', 'Virginia', 'Islas Vírgenes', 'Vermont', 'Washington', 'Wisconsin', 'Virginia Occidental', 'Wyoming']
			// const fallecidos = datos.map(item => item['núm de fallecidos']);
			// const poblacion = datos.map(item => item['población']);
			const fallecidosPorMillon = datos.map(item => {
				const fallecidos = item['núm de fallecidos'];
				const poblacion = item['población'];
				return (fallecidos / poblacion) * 1000000; // Resultado por millón de habitantes
			})

			const data = [{
				type: 'choropleth',
				locationmode: 'USA-states', // Modo de ubicación basado en los estados de EEUU
				locations: estados,
				z: fallecidosPorMillon, // Colores correspondientes a cada estado
				text: nombre_estados, // Nombre completo de cada estado
				color_continuous_scale: "Viridis", // Escala de colores
				colorbar: {
					title: {
						text: 'Número de fallecidos<br>por millón de<br>habitantes' // Usa <br> para los saltos de línea
					}
				} // Título de la barra de colores
			}];

			const layout = {
				geo: {
					scope: 'usa', // Centrar en Estados Unidos
					showlakes: true, // Mostrar lagos
					lakecolor: 'rgb(255, 255, 255)', // Color de los lagos
				},
				annotations: [ // Anotaciones del gráfico


				]
			};

			Plotly.newPlot('myMap', data, layout, { scrollZoom: false, displayModeBar: false });

		})


	</script>

</body>

</html>